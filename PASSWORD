<?php
function getRandomString() {
    return uniqid();
}

 $pw =getRandomString();
 function get_tiny_url($url){
	$ch = curl_init();
	$timeout = 5;
	curl_setopt($ch,CURLOPT_URL,'http://tinyurl.com/api-create.php?url='.$url);
	curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
	curl_setopt($ch,CURLOPT_CONNECTTIMEOUT,$timeout);
	$data = curl_exec($ch);
	curl_close($ch);
	return $data;
}
 $res = curl('https://dpaste.org', null, rentry())[1];
 $csrfmiddlewaretoken = explode('">',explode('name="csrfmiddlewaretoken" value="',$res)[1])[0];
 
 $res = curl('https://dpaste.org', "csrfmiddlewaretoken=$csrfmiddlewaretoken&title=&lexer=python&expires=3600&content=$pw", rentry())[1];
 $canonical = explode('"/>',explode('<input type="text" id="copyToClipboardField" value="https://dpaste.org/',$res)[1])[0];
///$newurl=get_tiny_url("https://dpaste.org/$canonical/raw");
$ch = curl_init("https://link4url.com/api?api=f4c495350f22d1d090a9d51f79ce19547159ae16&url=https://dpaste.org/$canonical/raw"); // such as http://example.com/example.xml
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_HEADER, 0);
 $data = curl_exec($ch);
 $shortenedUrl = json_decode($data,true)["shortenedUrl"];
//test it out!

 // à¤Ÿà¤°à¥à¤®à¤¿à¤¨à¤² à¤¸à¤¾à¤«à¤¼ à¤•à¤°à¥‡à¤‚ (Windows à¤”à¤° Linux/macOS à¤¦à¥‹à¤¨à¥‹à¤‚ à¤•à¥‡ à¤²à¤¿à¤)
@system(strtoupper(substr(PHP_OS, 0, 3)) === 'WIN' ? "cls" : "clear");

// ANSI à¤•à¤²à¤° à¤¸à¥‡à¤Ÿ à¤•à¤°à¥‡à¤‚ (Windows à¤•à¥‡ à¤²à¤¿à¤ à¤œà¤¾à¤‚à¤šà¥‡à¤‚)
$blue = "\033[1;34m";   // à¤¬à¥à¤²à¥‚ à¤•à¤²à¤°
$green = "\033[1;32m";  // à¤—à¥à¤°à¥€à¤¨ à¤•à¤²à¤°
$red = "\033[1;31m";    // à¤°à¥‡à¤¡ à¤•à¤²à¤°
$reset = "\033[0m";     // à¤•à¤²à¤° à¤°à¥€à¤¸à¥‡à¤Ÿ

// ASCII à¤†à¤°à¥à¤Ÿ à¤¸à¥à¤Ÿà¤¾à¤‡à¤²à¤¿à¤¶ à¤Ÿà¥‡à¤•à¥à¤¸à¥à¤Ÿ
echo $blue . "
  _____                                   
 |  __ \                                  
 | |__) |_ _ ___ _____   _____ _ __ __ _  
 |  ___/ _` / __/ __ \ \ / / _ \ '__/ _` | 
 | |  | (_| \__ \__ \ V /  __/ | | (_| |  
 |_|   \__,_|___/___/ \_/ \___|_|  \__,_|  
\n" . $reset;

// à¤²à¤¿à¤‚à¤• à¤ªà¥à¤°à¤¿à¤‚à¤Ÿ à¤•à¤°à¥‡à¤‚
//$new_url = "https://example.com"; // à¤…à¤¸à¤²à¥€ URL à¤¡à¤¾à¤²à¥‡à¤‚
echo "ðŸ”— Link Password: " . $green . $shortenedUrl . "\n" . $reset;

// à¤ªà¤¾à¤¸à¤µà¤°à¥à¤¡ à¤¸à¥‡à¤Ÿ à¤•à¤°à¥‡à¤‚ (à¤¸à¥à¤°à¤•à¥à¤·à¤¿à¤¤ à¤¤à¤°à¥€à¤•à¥‡ à¤¸à¥‡)
  // à¤…à¤¸à¤²à¥€ à¤ªà¤¾à¤¸à¤µà¤°à¥à¤¡

// à¤ªà¤¾à¤¸à¤µà¤°à¥à¤¡ à¤à¤‚à¤Ÿà¤° à¤•à¤°à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤«à¤‚à¤•à¥à¤¶à¤¨
function getPassword() {
    echo "[+] Enter Key: ";
    return trim(fgets(STDIN));
}

// à¤ªà¤¾à¤¸à¤µà¤°à¥à¤¡ à¤œà¤¾à¤‚à¤šà¤¨à¥‡ à¤•à¤¾ à¤«à¤‚à¤•à¥à¤¶à¤¨
function checkPassword($pw) {
    $attempt = getPassword();
    if ($attempt === $pw) {
        echo "\033[1;32mâœ… Password correct!\n\033[0m";
        sleep(2);
        file_put_contents("key", password_hash($pw, PASSWORD_BCRYPT));
        return true;
    }
    echo "\033[1;31mâŒ Wrong password!\n\033[0m";
    return false;
}

// à¤ªà¤¹à¤²à¥€ à¤¬à¤¾à¤° à¤ªà¤¾à¤¸à¤µà¤°à¥à¤¡ à¤šà¥‡à¤• à¤•à¤°à¥‡à¤‚
if (!checkPassword($pw)) {
    unlink("key");

    // à¤¬à¤¾à¤°-à¤¬à¤¾à¤° à¤ªà¤¾à¤¸à¤µà¤°à¥à¤¡ à¤®à¤¾à¤‚à¤—à¥‡à¤‚ à¤œà¤¬ à¤¤à¤• à¤¸à¤¹à¥€ à¤¨ à¤¹à¥‹
    while (!checkPassword($pw)) {
        sleep(2);
    }
}

echo "âœ… Access Granted!\n";/
